import{z as E,c as b}from"./index.esm.min.c6bc6a12.js";const m={default_5:[0],default_4:[0],weapon_5:[0],weapon_4:[0]};function P(){function h(p,w){let y=[0],g=1;for(let l=1;l<=p;++l){let r=Math.min(w(l)/1e4,1);y.push(g*r),g*=1-r}return y}m.default_5=h(90,p=>p<=73?60:60+600*(p-73)),m.default_4=h(10,p=>p<=8?510:510+5100*(p-8)),m.weapon_5=h(80,p=>p<=62?70:p<=73?70+700*(p-62):7770+350*(p-73)),m.weapon_4=h(10,p=>p<=7?600:p==8?6600:6600+3e3*(p-8))}const D={default:[{u:"0",v:"0",p:.5},{u:"0",v:"1",p:.5},{u:"1",v:"0",p:1}],weapon_5:[{u:"00",v:"00",p:.375},{u:"00",v:"01",p:.375},{u:"00",v:"11",p:.25},{u:"01",v:"00",p:.375},{u:"01",v:"02",p:.375},{u:"01",v:"12",p:.25},{u:"02",v:"00",p:1},{u:"10",v:"00",p:.5},{u:"10",v:"01",p:.5},{u:"11",v:"00",p:.5},{u:"11",v:"02",p:.5},{u:"12",v:"00",p:1}],weapon_4:[{u:"0",v:"0",p:.75},{u:"0",v:"1",p:.25},{u:"1",v:"0",p:1}],standard:[{u:"0",v:"0",p:1}]},c={character_5_up:{pityType:"default_5",graphType:"default",emit:{"0":1,"1":0}},character_5:{pityType:"default_5",graphType:"default",emit:{"0":1,"1":1}},character_4_up:{pityType:"default_4",graphType:"default",emit:{"0":1/3,"1":0}},weapon_5_ep:{pityType:"weapon_5",graphType:"weapon_5",emit:{"00":1,"01":0,"02":0,"10":0,"11":0,"12":0}},weapon_5_up:{pityType:"weapon_5",graphType:"weapon_5",emit:{"00":1,"01":1,"02":1,"10":0,"11":0,"12":0}},weapon_5:{pityType:"weapon_5",graphType:"weapon_5",emit:{"00":1,"01":1,"02":1,"10":1,"11":1,"12":1}},weapon_4_up:{pityType:"weapon_4",graphType:"weapon_4",emit:{"0":1/5,"1":0}},standard_5_ch:{pityType:"default_5",graphType:"standard",emit:{"0":.5/5}},standard_5_wp:{pityType:"default_5",graphType:"standard",emit:{"0":.5/10}},standard_5:{pityType:"default_5",graphType:"standard",emit:{"0":1}},standard_4_ch:{pityType:"default_4",graphType:"standard",emit:{"0":.5/23}},standard_4_wp:{pityType:"default_4",graphType:"standard",emit:{"0":.5/18}}};function U(h,p,w,y,g){if(!(h in c))throw new Error("Unknown itemType");if(p<=0)throw new Error("Pulls should be at least 1");let l=c[h],r=m[l.pityType],k=D[l.graphType],i=l.emit;if(w>=r.length-1)throw new Error("initPulls should be less than pity");if(!(y in i))throw new Error("Unknown initState");let a=[],u=[0],v=1;for(let e=1;e<r.length;++e)e>w?u.push(Math.min(r[e]/v,1)):v-=r[e];let T=E(r.length),_=0;for(let e=r.length-1;e>=0;--e)T[e]=_,_+=r[e];a.push(0);for(let e=p+1;e<u.length;++e)a[0]+=u[e];let d=b(u,T);_=a[0];for(let e=1;;++e){let t=d[p]||0;if(a.push(t),_+=t,g(_,e))break;d=b(d,r)}let s=E([a.length,a.length]),n={};for(let e in i)n[e]=E([a.length,a.length]);n[y][0][0]=s[0][0]=1;for(let e=0;e<a.length-1;++e){for(let t=0;t<=e;++t)for(let f of k)n[f.v][e+1][t]+=(1-i[f.v])*f.p*n[f.u][e][t],n[f.v][e+1][t+1]+=i[f.v]*f.p*n[f.u][e][t];for(let t=0;t<=e+1;++t)for(let f in i)s[t][e+1]+=n[f][e+1][t]}let o=[];_=0;for(let e=0;e<a.length;++e){o.push(0);for(let t=e;t<a.length;++t)o[e]+=s[e][t]*a[t];_+=o[e]}return o}function M(h,p,w,y,g){if(!(h in c))throw new Error("Unknown itemType");let l=c[h],r=m[l.pityType],k=D[l.graphType],i=l.emit;if(p>=r.length-1)throw new Error("initPulls should be less than pity");if(!(w in i))throw new Error("Unknown initState");if(!(y<1)&&g===void 0)throw new Error("No stop condition");let a=[0],u={},v=0;for(let n in i)u[n]=0;u[w]=1;for(let n=0;;++n){let o=0,e={};for(let t in i)e[t]=0;for(let t of k)o+=u[t.u]*t.p*i[t.v],e[t.v]+=u[t.u]*t.p*(1-i[t.v]);if(a.push(o),v+=o,v>y||n>g)break;u=e}let T=[0],_=1;for(let n=1;n<r.length;++n)n>p?T.push(Math.min(r[n]/_,1)):_-=r[n];let d=[0],s=T;for(let n=1;n<a.length;++n){for(let o=1;o<s.length;++o)d.length==o&&d.push(0),d[o]+=a[n]*s[o];if(n==a.length-1)break;s=b(s,r)}return d}(function(){P()})();export{U as a,M as i};
